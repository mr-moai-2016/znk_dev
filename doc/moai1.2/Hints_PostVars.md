# Hints PostVars
-----------------------------------

## <a name="index">目次
-----------------------------------
* [Post変数 js](#pv_js)
* [Post変数 pthb](#pv_pthb)
* [Post変数 pthc](#pv_pthc)
* [Post変数 pthd](#pv_pthd)
* [Post変数 ptua](#pv_ptua)
* [Post変数 scsz](#pv_scsz)
* [Post変数 pwd](#pv_pwd)
* [Post変数 flrv](#pv_flrv)
* [Post変数 flvv](#pv_flvv)

## <a name="pv_js">Post変数 js
-----------------------------------
  この値は女子小学s…ではなく、JavaScriptを実行したかどうかを判断するためのものであり、
  /bin/base4.js を実行すると on に設定される仕組みとなっている.
  ( 無論、JavaScriptの/bin/base4.jsを実行させずとも、最初からこのPost変数に on 値を設定しておけば良い. )
  これを on にしておかないと「環境変数がありません(JavaScriptがオフ？)」というエラーが表示され、投稿に失敗する.
  よってこの値は必ず on にしておかなければならない.

  <a href="#user-content-index">目次へ戻る</a>

## <a name="pv_pthb"><a name="pv_pthc"><a name="pv_pthd">Post変数 pthb, pthc, pthd
-----------------------------------

  ptはPosT の意味であろう. h は不明である. なぜ a からではなく b から始まるのかも不明である.

  この値はfutaba.phpに初アクセスした時間(およびそれに類した値)である. 現状では
  カタログに初めてアクセスするか、または初めてレス投稿した際にまずpthcに設定されるようである.
  あるいは /bin/cachemt7.php にアクセスしたときにそれに類した値が生成される形となる.
  一度目の投稿においては、localStorage(futabapt)にpthcのコピー値も設定される.
  また二度目の投稿において、さらにそのlocalStorage(futabapt)のコピー値がpthbへと設定される.
  おそらくpthbの値の存在によってlocalStorageに確実に値が設定されたことを確認する意図があると思われる.
  pthdは現状では使用されている気配はない.

  一旦設定されると、CookieおよびブラウザキャッシュおよびlocalStorage これら全てを
  消去しない限り同じ値が残り続ける.

  <a href="#user-content-index">目次へ戻る</a>

## <a name="pv_ptua">Post変数 ptua
-----------------------------------

  この値は頻繁にその意味が変更される歴史を持つ.
  最初期はnavigator.userAgentの文字列値をそのまま格納していたため、名前に ua という文字が含まれているのであろう.

  現状での意味は、33個のものブラウザとそのバージョン固有の真偽値をとるJavascriptコード片(Snippetと呼ぶ)の結果値を、
  33bitのフラグ値にパックした上で10進数変換したものである.
  この計算はレス投稿(ptfk関数)時に毎回 /bin/base4.jsで行われており、sphという名前の配列変数を検索すると該当処理を行っている行を見つけることができる.
  (尚、最大値は32bit非負整数のMaxを超える可能性があるため、浮動小数点数をベースとして行われている模様).

  要はブラウザとそのバージョン固有の値の寄せ集めであるため、ブラウザそのものあるいは場合によってはそのバージョンのみでも良いが、
  そのいずれかを変更しない限り基本的に同じ値をとり続ける.

  尚、この値を乱数生成器などで出力される完全なランダムな整数値として割り当てても、少なくとも筆者の環境では現状問題ないようである.
  ただ、下位16bitはIEに関するものであるため、IE以外のブラウザとして偽装したいなら、その数字を必ず256の倍数にすれば「それらしく」偽装できる.
  それ以外にも各Snippetの意味を事細かに調べてブラウザとバージョン毎に反映させていけば値の精度はより高まるであろう.
  自分で値を偽装される方でこの辺りに拘りのある方は参考にされてはどうだろうか？

  <a href="#user-content-index">目次へ戻る</a>

## <a name="pv_scsz">Post変数 scsz
-----------------------------------

  名前の由来は SCreenSiZe であろう. 

  この値は、あなたの使っているモニタの解像度と色深度の情報を示す.
  (Javascriptにこれを取得するAPIがあり、レス投稿(ptfk関数)時に毎回 /bin/base4.jsでこれを取得しているようである)

~~~
    モニタ解像度の幅 x モニタ解像度の高さ x モニタの色深度ビット数
~~~

  というフォーマットを持つ記述子となる.
  例えば、640x480x24、1024x768x32といった値をとる.

  <a href="#user-content-index">目次へ戻る</a>


## <a name="pv_pwd">Post変数 pwd
-----------------------------------

  この値は、レス投稿時のいわゆる「削除キー」に相当するものである.
  ユーザが明示的に指定してもよいが、通常空にしておけば適当なキー値が自動的に割り当てられるので
  割り当てられた後はそれをそのまま使えばよい.
  ユーザ情報をリセットしたい場合は、これを一旦空にしておくとよい.

  <a href="#user-content-index">目次へ戻る</a>

## <a name="pv_flrv"><a name="pv_flvv">Post変数 flrv flvv
-----------------------------------

  この値は、Fingerprint値と呼ばれるものが格納される.

  これはあなたのブラウザ環境やマシン環境の様々な情報をJavascriptにより取得し、
  それらを集めて連結した一つの巨大文字列を元に32bit整数のハッシュ値を計算したものである.
  ブラウザやマシン環境に依存した情報であるため、これらが変わればこのFingerprint値は変化する.
  flrvとflvvの違いはその取得する情報の種類だけである.
  flrvが取得する全情報に加え、ブラウザのプラグイン情報文字列まで加味したものがflvvである.

  ハッシュ値が何のことかわからない方は、次のように考えればよい.
  例えばあなたのマシンの特徴を示す情報が３つあったとしてそれをそれぞれ仮に
  数字の 2, 4, 7 とする. これらを足し算して合計すると 2 + 4 + 7 = 13 となるが、
  この 13 がハッシュ値に相当しここではこれが送信される. 非常に大雑把だが、
  とりあえずそのようなイメージで十分である.

  ここでのポイントは 13 から元の値 2, 4, 7 を一意には復元できないということである.
  よってこの値は実のところデタラメに設定しても一般にその妥当性を検証する術はない.  
  これを不可逆と言う. この点はptuaとは大きく異なる.

  <a href="#user-content-index">目次へ戻る</a>


[1]: https://github.com/mr-moai-2016/znk_dev/blob/master/src/moai/Hints_PostVars.md
